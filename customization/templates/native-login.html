{% extends "page.html" %}

{% block title %}CTSM JupyterHub{% endblock %}

{% block favicon %}
<link rel="icon" href="https://raw.githubusercontent.com/NicholasCote/cirrus-ctsm-jhub-ncote/main/customization/static/images/favicon.ico" type="image/x-icon">
{% endblock %}

{% block stylesheet %}
{{ super() }}
<link rel="stylesheet" href="/hub/static/custom/css/style.css">
{% endblock %}

{% block logo %}
<span id="jupyterhub-logo" class="navbar-brand d-flex align-items-center">
  <a href="https://jupyter.org/hub">
    <img src='{{ base_url }}logo' alt='JupyterHub logo' class='jpy-logo' title='Home' />
  </a>
  <a href="https://ncar.ucar.edu/">
    <img src="https://raw.githubusercontent.com/NicholasCote/cirrus-ctsm-jhub-ncote/main/customization/static/images/NSF-NCAR_Logo_Color-Blue_RGB.png" 
         alt="NCAR Logo" class="ncar-logo-navbar ms-3">
  </a>
</span>
{% endblock %}

{% block script %}
{{ super() }}
<script type="text/javascript">
    document.addEventListener('DOMContentLoaded', function() {
        let button = document.getElementById('eye');
        button.addEventListener("click", function(e) {
            let pwd = document.getElementById("password_input");
            if (pwd.getAttribute("type") === "password") {
                pwd.setAttribute("type", "text");
                button.textContent = "üîë";
            } else {
                pwd.setAttribute("type", "password");
                button.textContent = "üëÅ";
            }
        });
    });

    if (window.location.protocol === "http:") {
        let warning = document.getElementById('insecure-login-warning');
        warning.className = warning.className.replace(/\bhidden\b/, '');
    }
</script>
{% endblock script %}

{% block main %}
<div class="login-container">
    <div class="login-header">
        <h1>CTSM JupyterHub</h1>
        <p class="login-subtitle">Run CTSM Example Workflows</p>
    </div>

    <div id="login-main" class="container">
        <form action="{{login_url}}?next={{next}}" method="post" role="form">
            <div class="auth-form-header">Sign In</div>

            <div class='auth-form-body'>
                <p id='insecure-login-warning' class='hidden'>
                    Warning: JupyterHub seems to be served over an unsecured HTTP connection.
                </p>

                {% if login_error %}
                <p class="login_error">{{login_error}}</p>
                {% endif %}

                <input type="hidden" name="_xsrf" value="{{ xsrf }}"/>
                <label for="username_input">Username:</label>
                <input id="username_input" type="text" name="username" val="{{username}}" 
                       autocapitalize="off" autocorrect="off" class="form-control" 
                       autofocus="autofocus" required />

                <label for='password_input'>Password:</label>
                <div class="input-group">
                    <input id="password_input" type="password" name="password" 
                           autocapitalize="off" autocorrect="off" class="form-control" />
                    <span class="input-group-addon">
                        <button id="eye" type="button" style="border:0;">üëÅ</button>
                    </span>
                </div>

                <input type="submit" id="login_submit" class='btn btn-jupyter' value='Sign In' />

                <hr />
                <p><a href="{{ base_url }}signup">Sign up</a> to create a new user.</p>
            </div>
        </form>
    </div>
    
    <div class="login-details">
        <h4>New to CTSM JupyterHub?</h4>
        <p>
            <strong>New users:</strong> Click <a href="{{ base_url }}signup">Sign up</a> to create 
            an account. After signup, an administrator will review your request. Check back in 1-2 
            business days to sign in with your credentials.
        </p>
        <p>
            <strong>Already have an account?</strong> Enter your username and password above to 
            sign in. If you've forgotten your password, contact an administrator at 
            <a href="mailto:ctsm-project@ucar.edu">ctsm-project@ucar.edu</a> for assistance. 
            You can change your password anytime after logging in by visiting your account settings.
        </p>
    </div>
    
    <div class="jhub-help-text">
        <p>
            Need help? Visit the 
            <a href="https://github.com/ESCOMP/CTSM" target="_blank">CTSM GitHub Repo</a>
            or email <a href="mailto:ctsm-project@ucar.edu">ctsm-project@ucar.edu</a>
        </p>
    </div>
</div>
{% endblock main %}